# Name: Recursive assertions

SELECT DISTINCT ?n WHERE {
  ?n :annotations/:name "Test" ;
     :in ?call .

  ?call :nodetype "MethodCallExpr" ;
        :name ?name ;
        :declaration ?decl .
  
  FILTER(STRSTARTS(?name, "assert")).
  
  # Self-call inside its body
  ?decl :in/(:in|:next)* ?other ;
  ?other :nodetype "MethodCallExpr"
         :name ?othername .
  
  FILTER (?name = ?othername) .
}
